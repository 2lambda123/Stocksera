{% extends "format.html" %}
{% load static %}
{% load filter %}

{% block title %}StocksEra | Reddit Crypto{% endblock %}

{% block additional_script %}
<link rel="stylesheet" href="{% static 'style/reddit_ticker_analysis.css' %}">
<script src="{% static 'javascript/reddit_ticker_analysis.js' %}"></script>
{% endblock %}

{% block onload_properties%}restore_dark_mode();rank_chart(){% endblock %}

{% block main_nav %}
    <a href="/">Stocksera</a> /
    <a href="/reddit_analysis/?subreddit=cryptocurrency">Reddit Sentiment</a> /
    <a href="/reddit_ticker_analysis/?quote={{ticker_selected}}&subreddit=cryptocurrency">Reddit Ranking [{{ticker_selected}}]</a>
{% endblock %}

{% block main_content %}
    <script>highlight_selected_nav('reddit')</script>
    <div class="instructions">
        <h2>Reddit Crypto Analysis</h2>
        <p>View ranking of popular cryptocurrencies in Reddit over time and compare it with its price.</p>
    </div>

    <div class="reddit_ticker_analysis">
        <form action="" method="GET" autocomplete="off">
            <select name="subreddit" onchange="this.form.submit()">
                <option>Subreddit: CryptoCurrency</option>
            </select>
            <input placeholder="TICKER: " name="quote" value="{{ticker_selected}}">
            <button>SEARCH</button>
        </form>

        <h2>Ranking of ${{ticker_selected}} in r/CryptoCurrency over time</h2>
        <div class="ranking_description">The lower the ranking, the more popular the ticker.</div>

        <div class="chart-container">
            <canvas id="rank_chart"></canvas>
        </div>

        <table id="reddit_table" style="display:none">
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>48H Score</th>
                    <th>Previous Close</th>
                    <th>Date (DD/MM/YYYY)</th>
                </tr>
            </thead>
            <tbody>
                {% for rank in ranking %}
                    <tr>
                        <td>{{rank.0}}</td>
                        <td>{{rank.1}}</td>
                        <td>{{rank.2}}</td>
                        <td>{{rank.3}}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}

{% block bottom_script %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
{% endblock %}